# 3-3 Implement TASK Variable Resolver

[Back to task list](./tasks.md)

## Description

Implement the TASK variable resolver that extracts task IDs from open markdown files matching the project's task file pattern.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-12-23 12:00:00 | Created | N/A | Proposed | Task file created | User |

## Requirements

1. Scan visible/open text editors for potential task files
2. Match pattern: file path contains `docs/delivery/` and filename matches `\d+-\d+\.md`
3. Extract task ID from filename (e.g., `1-3.md` â†’ `1-3`)
4. If multiple matches, use the active editor if it matches, otherwise most recently focused
5. Return undefined if no match (triggers manual fallback)

## Implementation Plan

1. Add TASK resolver to templateEngine.ts
2. Get all visible text editors: `vscode.window.visibleTextEditors`
3. Filter editors by path pattern:
   - Contains `/docs/delivery/`
   - Filename matches `/^\d+-\d+\.md$/`
4. Extract task ID from first match's filename
5. Prefer active editor if it matches pattern
6. Return undefined if no matches

## Verification

- [ ] Detects task file when open in editor
- [ ] Extracts correct task ID from filename
- [ ] Prefers active editor when multiple task files open
- [ ] Returns undefined when no task files open

## Test Plan

- Open task file (e.g., `1-3.md`), TASK resolves to `1-3`
- No task file open, TASK triggers manual input
- Multiple task files, active one preferred

## Files Modified

- `src/templateEngine.ts` (modified)

