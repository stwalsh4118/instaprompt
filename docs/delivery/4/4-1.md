# 4-1 Create Webview Markdown Editor Panel

[Back to task list](./tasks.md)

## Description

Create a webview panel with a split-view markdown editor (CodeMirror or Monaco) on the left and live preview on the right. The editor should support markdown syntax highlighting and the preview should render markdown to HTML in real-time.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-12-25 12:00:00 | Created | N/A | Proposed | Task file created | User |
| 2026-01-08 17:19:21 | Status Change | Proposed | Done | Implementation completed - webview markdown editor with CodeMirror 6 and live preview | AI Agent |

## Requirements

1. Create webview panel using VS Code webview API
2. Implement split-view layout (editor left, preview right)
3. Integrate markdown editor (CodeMirror 6 or Monaco Editor)
4. Integrate markdown renderer (marked library)
5. Support bidirectional communication between webview and extension
6. Handle save and cancel actions from webview
7. Support loading existing content into editor

## Implementation Plan

1. **Create webview module** (`src/markdownEditor.ts`):
   - Function to create and show webview panel
   - Function to generate HTML content for webview
   - Message handlers for save/cancel/update events

2. **Webview HTML structure**:
   - Split container with CSS flexbox (50/50 split)
   - Editor container on left
   - Preview container on right
   - Toolbar with Save/Cancel buttons

3. **Integrate CodeMirror 6**:
   - Load CodeMirror from CDN or bundle
   - Configure for markdown mode
   - Set up change listener to update preview

4. **Integrate marked library**:
   - Load marked from CDN or bundle
   - Render markdown to HTML on editor changes
   - Update preview pane with rendered HTML

5. **Message passing**:
   - Extension → Webview: Load content, show/hide
   - Webview → Extension: Save content, cancel, request initial content

6. **State management**:
   - Track webview panel instance
   - Store current content being edited
   - Handle panel disposal

## Verification

- [ ] Webview panel opens successfully
- [ ] Editor displays markdown with syntax highlighting
- [ ] Preview updates in real-time as user types
- [ ] Save button sends content to extension
- [ ] Cancel button closes panel without saving
- [ ] Existing content loads into editor correctly

## Test Plan

- Open webview editor, verify split view renders
- Type markdown, verify preview updates
- Test headers, lists, code blocks, emphasis
- Click save, verify content is received by extension
- Click cancel, verify panel closes without saving
- Load existing prompt content, verify it appears in editor

## Files Modified

- `src/markdownEditor.ts` (created)
- `package.json` (add dependencies: marked, @codemirror/view, @codemirror/lang-markdown, @codemirror/state)

