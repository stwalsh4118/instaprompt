# 4-4 Implement Import Prompt from .md File

[Back to task list](./tasks.md)

## Description

Add a command that allows users to import markdown files as new prompts. Users should be able to select one or more .md files and have them imported as prompts with filenames as prompt names.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-12-25 12:00:00 | Created | N/A | Proposed | Task file created | User |

## Requirements

1. Create new command `instaprompt.importPrompt`
2. Show open dialog to select .md file(s)
3. Read file content using VS Code file system API
4. Extract prompt name from filename (remove .md extension)
5. Create new prompt with file content
6. Handle multiple file import
7. Show success/error notifications
8. Handle duplicate names (append number or prompt user)

## Implementation Plan

1. **Create `handleImportPrompt()` function in `extension.ts`**:
   - Show open dialog with `.md` file filter
   - Allow multiple file selection
   - User selects one or more .md files

2. **Read files**:
   - Use `vscode.workspace.fs.readFile()` for each selected file
   - Decode UTF-8 content
   - Extract filename without extension for prompt name

3. **Create prompts**:
   - For each file: call `addPrompt(name, content)`
   - Handle name conflicts: if prompt name exists, append number (e.g., "Prompt (1)")
   - Or prompt user for new name (simpler: auto-append number)

4. **Error handling**:
   - Handle file read errors
   - Handle dialog cancellation
   - Handle invalid file format
   - Show appropriate error messages

5. **Success feedback**:
   - Show notification with count of imported prompts
   - List imported prompt names

6. **Optional: Frontmatter parsing**:
   - If file has frontmatter, extract metadata (deferred per PRD)
   - For now, just use filename as name and file content as prompt content

## Verification

- [ ] Import command appears in command palette
- [ ] Open dialog filters to .md files
- [ ] Can select single file for import
- [ ] Can select multiple files for import
- [ ] File content is read correctly
- [ ] Prompt is created with filename as name
- [ ] Prompt content matches file content
- [ ] Duplicate names handled (appended number)
- [ ] Success notification shown
- [ ] Error handling works correctly

## Test Plan

- Import single file: select .md file, verify prompt created with correct name and content
- Import multiple files: select multiple .md files, verify all prompts created
- Cancel import: open dialog, cancel, verify no prompts created
- Duplicate name: import file with name matching existing prompt, verify number appended
- Error handling: try to import invalid file, verify error notification
- Verify imported prompt content matches file content exactly

## Files Modified

- `src/extension.ts` (modified)
  - Add `handleImportPrompt()` function
  - Register `instaprompt.importPrompt` command
- `package.json` (modified)
  - Add command entry for import prompt

