# 4-5 Ensure Clipboard Preserves Markdown

[Back to task list](./tasks.md)

## Description

Verify that the existing clipboard copy functionality preserves raw markdown syntax when copying prompts. The current implementation should already work, but we need to verify and document this behavior.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-12-25 12:00:00 | Created | N/A | Proposed | Task file created | User |

## Requirements

1. Verify `vscode.env.clipboard.writeText()` preserves markdown syntax
2. Test copying prompts with markdown formatting
3. Verify markdown syntax is copied as-is (e.g., `**bold**` stays as `**bold**`)
4. Document the behavior in code comments
5. Add test cases if needed

## Implementation Plan

1. **Review current clipboard implementation**:
   - Check `handleSelectPrompt()` in `extension.ts`
   - Verify `vscode.env.clipboard.writeText()` is used
   - Confirm it copies raw string content

2. **Test markdown preservation**:
   - Create test prompt with markdown (headers, lists, code blocks, emphasis)
   - Copy prompt to clipboard
   - Paste into text editor
   - Verify markdown syntax is preserved

3. **Verify template resolution**:
   - Ensure template variables are resolved before copying
   - Verify resolved content preserves markdown if template output is markdown
   - Test edge cases (variables in code blocks, etc.)

4. **Documentation**:
   - Add code comments explaining markdown preservation
   - Update PRD if needed to clarify behavior

5. **Edge cases**:
   - Test with special characters
   - Test with code blocks containing markdown-like syntax
   - Test with very long prompts

## Verification

- [ ] Clipboard write preserves markdown syntax exactly
- [ ] Headers (`#`, `##`) copied as-is
- [ ] Lists (`-`, `*`, numbered) copied as-is
- [ ] Code blocks (triple backticks) copied as-is
- [ ] Emphasis (`**bold**`, `*italic*`) copied as-is
- [ ] Links (`[text](url)`) copied as-is
- [ ] Template resolution doesn't break markdown
- [ ] Special characters handled correctly

## Test Plan

- Create prompt with markdown: headers, lists, code blocks, emphasis, links
- Copy prompt to clipboard
- Paste into VS Code editor, verify markdown syntax preserved
- Paste into external text editor, verify markdown syntax preserved
- Test with template variables in markdown, verify resolution works
- Test edge cases: code blocks with markdown-like content, special characters

## Files Modified

- `src/extension.ts` (modified)
  - Add comments documenting markdown preservation behavior
  - Verify no changes needed to clipboard logic (should already work)
- Documentation updates if needed

