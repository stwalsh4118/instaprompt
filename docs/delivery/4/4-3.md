# 4-3 Implement Export Prompt to .md File

[Back to task list](./tasks.md)

## Description

Add a command that allows users to export one or more prompts as markdown files to their filesystem. Users should be able to select which prompts to export and choose the save location.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-12-25 12:00:00 | Created | N/A | Proposed | Task file created | User |

## Requirements

1. Create new command `instaprompt.exportPrompt`
2. Show quick pick to select one or more prompts to export
3. Show save dialog to choose export location
4. Write prompt content to .md file(s)
5. Handle single vs multiple prompt export
6. Use prompt name as default filename (sanitized)
7. Show success/error notifications

## Implementation Plan

1. **Create `handleExportPrompt()` function in `extension.ts`**:
   - Get all prompts using `getPrompts()`
   - Show quick pick with multi-select enabled
   - User selects one or more prompts

2. **Show save dialog**:
   - If single prompt: `vscode.window.showSaveDialog()` with prompt name as default
   - If multiple prompts: `vscode.window.showOpenDialog()` to select directory, then save each prompt as separate file

3. **File writing**:
   - Use `vscode.workspace.fs.writeFile()` to write markdown content
   - Sanitize prompt name for filename (remove invalid chars, handle spaces)
   - File format: plain markdown with prompt content
   - Optional: Add frontmatter with prompt metadata (deferred per PRD)

4. **Error handling**:
   - Handle file write errors
   - Handle dialog cancellation
   - Show appropriate error messages

5. **Success feedback**:
   - Show notification with count of exported prompts
   - Show file path(s) in notification

## Verification

- [ ] Export command appears in command palette
- [ ] Quick pick shows all prompts
- [ ] Can select single prompt for export
- [ ] Can select multiple prompts for export
- [ ] Save dialog shows with correct default filename
- [ ] File is written with prompt content
- [ ] Success notification shown
- [ ] Error handling works correctly

## Test Plan

- Export single prompt: select prompt, choose location, verify file created with content
- Export multiple prompts: select multiple, choose directory, verify all files created
- Cancel export: select prompts, cancel save dialog, verify no files created
- Error handling: try to save to read-only location, verify error notification
- Verify exported markdown content matches prompt content exactly

## Files Modified

- `src/extension.ts` (modified)
  - Add `handleExportPrompt()` function
  - Register `instaprompt.exportPrompt` command
- `package.json` (modified)
  - Add command entry for export prompt

